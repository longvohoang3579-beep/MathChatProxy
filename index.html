<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>AI Assistant Pro</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<style>
body {
  background-color:#0f0f13; color:#fff; font-family:'Segoe UI',sans-serif;
  margin:0; padding:0; overflow:hidden;
}

/* ---------- INTRO ---------- */
#intro-screen {
  position: fixed;
  top:0; left:0; width:100%; height:100vh;
  display:flex; align-items:center; justify-content:center;
  flex-direction:column; z-index:1000;
  background: radial-gradient(circle at 50% 50%, #10131d 0%, #05060a 70%);
  transition: opacity 1.5s ease;
  overflow:hidden;
}
#intro-bg {
  position:absolute; top:0; left:0; width:100%; height:100%;
  background: radial-gradient(circle at 30% 30%, rgba(0,255,255,0.05), transparent 70%),
              radial-gradient(circle at 70% 70%, rgba(255,0,255,0.06), transparent 70%);
  filter: blur(25px);
  animation: glowShift 10s ease-in-out infinite alternate;
}
@keyframes glowShift {
  0% { transform: scale(1); }
  100% { transform: scale(1.1) translate(-10px,10px); }
}
.dragon, .phoenix {
  position:absolute;
  width:200px; height:200px;
  opacity:0.5;
  filter: blur(15px);
  border-radius:50%;
  animation: swirl 12s linear infinite;
}
.dragon {
  top:25%; left:15%;
  background: linear-gradient(45deg, rgba(0,255,200,0.4), rgba(255,0,150,0.3));
  animation-delay:-2s;
}
.phoenix {
  bottom:15%; right:15%;
  background: linear-gradient(-45deg, rgba(255,200,0,0.4), rgba(0,255,255,0.3));
  animation-delay:-5s;
}
@keyframes swirl {
  0% { transform: rotate(0deg) scale(1); }
  50% { transform: rotate(180deg) scale(1.1); }
  100% { transform: rotate(360deg) scale(1); }
}
#intro-text {
  position:relative;
  color:#facc15;
  font-size:2.3rem; font-weight:bold;
  text-shadow:0 0 20px rgba(255,255,150,0.8), 0 0 40px rgba(255,255,255,0.4);
  animation: floatText 3s ease-in-out infinite alternate;
}
@keyframes floatText {
  0% { transform: translateY(0); opacity:1; }
  100% { transform: translateY(-10px); opacity:0.95; }
}
#intro-subtext {
  color:#e0e7ff;
  margin-top:1rem;
  font-size:1.1rem;
  opacity:0.85;
  text-shadow:0 0 10px rgba(255,255,255,0.3);
  animation: fadeIn 3s ease-in-out 1.5s forwards;
  opacity:0;
}
@keyframes fadeIn {
  from { opacity:0; }
  to { opacity:1; }
}

/* ---------- MAIN APP ---------- */
.container {max-width:900px;margin:2rem auto;background:#1a1c29;border-radius:1.5rem;padding:1.5rem;box-shadow:0 15px 30px rgba(0,0,0,0.7);display:none;}
.tabs {display:flex;border-bottom:2px solid #333;margin-bottom:1rem;}
.tab-btn {flex:1;text-align:center;padding:1rem;cursor:pointer;color:#aaa;font-weight:bold;transition:all 0.2s;}
.tab-btn.active {color:#fff;border-bottom:3px solid #facc15;}
.tab-content {display:none;}
.tab-content.active {display:block;}
.chat-box {background:#111827;border-radius:12px;padding:1rem;height:400px;overflow-y:auto;display:flex;flex-direction:column;}
.bubble {max-width:80%;padding:10px 14px;border-radius:12px;margin-bottom:10px;line-height:1.5;word-wrap:break-word;white-space:pre-wrap;}
.user-bubble {background:#2563eb;align-self:flex-end;color:white;border-bottom-right-radius:2px;}
.ai-bubble {background:#374151;align-self:flex-start;color:#e5e7eb;border-bottom-left-radius:2px;}
mark.highlight {background-color:#fde047;color:black;font-weight:bold;padding:0 3px;border-radius:3px;}
textarea,input{width:100%;padding:0.75rem;border-radius:0.75rem;background:#1e1e2a;border:1px solid #333;color:white;resize:none;outline:none;}
button{padding:0.75rem 1rem;border-radius:0.75rem;font-weight:bold;cursor:pointer;transition:all 0.2s;}
#btnCreateImage{background:#10b981;color:#111827;}#btnCreateImage:hover{background:#059669;}
#btnChat{background:#6366f1;color:white;}#btnChat:hover{background:#4f46e5;}
#btnMath{background:#f59e0b;color:#111827;}#btnMath:hover{background:#d97706;}
img.generated-image{border-radius:12px;max-width:100%;margin-top:1rem;}
.generated-video{border-radius:12px;max-width:100%;margin-top:1rem;}
</style>
</head>

<body>
<!-- INTRO -->
<div id="intro-screen">
  <div id="intro-bg"></div>
  <div class="dragon"></div>
  <div class="phoenix"></div>
  <div id="intro-text">üåå Welcome to <mark class="highlight">AI Assistant Pro</mark> üåå</div>
  <div id="intro-subtext">Unleash the magic of creativity and intelligence.</div>
</div>

<!-- MAIN -->
<div class="container" id="mainApp">
  <div class="tabs">
    <div class="tab-btn active" data-tab="image">üñºÔ∏è T·∫°o ·∫¢nh</div>
    <div class="tab-btn" data-tab="chat">üí¨ Chat</div>
    <div class="tab-btn" data-tab="math">üßÆ Gi·∫£i To√°n</div>
    <div class="tab-btn" data-tab="video">üéûÔ∏è T·∫°o Video</div>
  </div>

  <!-- ·∫¢NH -->
  <div class="tab-content active" id="image">
    <div class="chat-box" id="imageBox"></div>
    <textarea id="imagePrompt" rows="2" placeholder="Nh·∫≠p m√¥ t·∫£ ·∫£nh..."></textarea>
    <button id="btnCreateImage" class="mt-2 w-full">T·∫°o ·∫¢nh</button>
  </div>

  <!-- CHAT -->
  <div class="tab-content" id="chat">
    <div class="chat-box" id="chatBox"></div>
    <textarea id="chatInput" rows="2" placeholder="Nh·∫≠p tin nh·∫Øn..."></textarea>
    <button id="btnChat" class="mt-2 w-full">G·ª≠i</button>
  </div>

  <!-- TO√ÅN -->
  <div class="tab-content" id="math">
    <div class="chat-box" id="mathBox"></div>
    <textarea id="mathPrompt" rows="2" placeholder="Nh·∫≠p b√†i to√°n..."></textarea>
    <button id="btnMath" class="mt-2 w-full">Gi·∫£i</button>
  </div>

  <!-- VIDEO -->
  <div class="tab-content" id="video">
    <div class="chat-box" id="videoBox"></div>
    <textarea id="videoPrompt" rows="2" placeholder="Nh·∫≠p m√¥ t·∫£ video..."></textarea>
    <button id="btnVideo" class="mt-2 w-full">T·∫°o Video</button>
  </div>
</div>

<script>
// ----- Hi·ªáu ·ª©ng Intro -----
function playIntro() {
  const intro = document.getElementById("intro-screen");
  const mainApp = document.getElementById("mainApp");
  setTimeout(() => {
    intro.style.opacity = "0";
    setTimeout(() => {
      intro.style.display = "none";
      mainApp.style.display = "block";
      document.body.style.overflow = "auto";
    }, 1500);
  }, 4000);
}
playIntro();

// ----- Tabs -----
const tabs=document.querySelectorAll(".tab-btn");
const contents=document.querySelectorAll(".tab-content");
tabs.forEach(tab=>tab.addEventListener("click",()=>{
  tabs.forEach(t=>t.classList.remove("active"));
  contents.forEach(c=>c.classList.remove("active"));
  tab.classList.add("active");
  document.getElementById(tab.dataset.tab).classList.add("active");
}));

// ----- API Calls -----
async function postData(url, data, isImage=false) {
  const res = await fetch(url, {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify(data)
  });
  if (isImage) return res.blob();
  return res.json();
}

// 1Ô∏è‚É£ T·∫°o ·∫¢nh
document.getElementById("btnCreateImage").addEventListener("click", async ()=>{
  const prompt = document.getElementById("imagePrompt").value.trim();
  if(!prompt) return;
  const box = document.getElementById("imageBox");
  box.innerHTML += `<div class="bubble user-bubble">${prompt}</div>`;
  const blob = await postData("/api/create-image",{prompt}, true);
  const url = URL.createObjectURL(blob);
  box.innerHTML += `<div class="bubble ai-bubble"><img src="${url}" class="generated-image"></div>`;
  box.scrollTop = box.scrollHeight;
});

// 2Ô∏è‚É£ Chat
document.getElementById("btnChat").addEventListener("click", async ()=>{
  const prompt = document.getElementById("chatInput").value.trim();
  if(!prompt) return;
  const box = document.getElementById("chatBox");
  box.innerHTML += `<div class="bubble user-bubble">${prompt}</div>`;
  const res = await postData("/api/chat",{prompt});
  box.innerHTML += `<div class="bubble ai-bubble">${res.reply}</div>`;
  box.scrollTop = box.scrollHeight;
});

// 3Ô∏è‚É£ Gi·∫£i To√°n
document.getElementById("btnMath").addEventListener("click", async ()=>{
  const prompt = document.getElementById("mathPrompt").value.trim();
  if(!prompt) return;
  const box = document.getElementById("mathBox");
  box.innerHTML += `<div class="bubble user-bubble">${prompt}</div>`;
  const res = await postData("/api/math",{prompt});
  box.innerHTML += `<div class="bubble ai-bubble">${res.solution}</div>`;
  MathJax.typesetPromise();
  box.scrollTop = box.scrollHeight;
});

// 4Ô∏è‚É£ T·∫°o Video
document.getElementById("btnVideo").addEventListener("click", async ()=>{
  const prompt = document.getElementById("videoPrompt").value.trim();
  if(!prompt) return;
  const box = document.getElementById("videoBox");
  box.innerHTML += `<div class="bubble user-bubble">${prompt}</div>`;
  const res = await postData("/api/create-video",{prompt});
  box.innerHTML += `<div class="bubble ai-bubble"><video class="generated-video" controls src="${res.videoUrl}"></video></div>`;
  box.scrollTop = box.scrollHeight;
});
</script>
</body>
</html>
